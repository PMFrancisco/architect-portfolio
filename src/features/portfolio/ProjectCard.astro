---
/**
 * ProjectCard Component
 * Swiss-style project card with image, metadata, and hover effects
 */
import Typography from '../../shared/ui/Typography.astro';
import Icon from '../../shared/ui/Icon.astro';
import type { Lang } from '../../shared/i18n/translations';

interface Props {
  title: string;
  slug: string;
  category: string;
  year: number;
  location: string;
  description: string;
  image?: string;
  featured?: boolean;
  lang: Lang;
  class?: string;
}

const { 
  title, 
  slug, 
  category, 
  year, 
  location, 
  description,
  image,
  featured = false,
  lang,
  class: className = '' 
} = Astro.props;

const projectsPath = lang === 'es' ? 'proyectos' : 'projects';
const href = `/${lang}/${projectsPath}/${slug}`;

// Category labels
const categoryLabels: Record<string, Record<Lang, string>> = {
  residencial: { es: 'Residencial', en: 'Residential' },
  comercial: { es: 'Comercial', en: 'Commercial' },
  institucional: { es: 'Institucional', en: 'Institutional' },
  urbanismo: { es: 'Urbanismo', en: 'Urban Planning' },
  interiorismo: { es: 'Interiorismo', en: 'Interior Design' },
  consultoria: { es: 'Consultoría', en: 'Consulting' },
};

const categoryLabel = categoryLabels[category]?.[lang] || category;
---

<a 
  href={href} 
  class:list={[
    'group block',
    featured && 'lg:col-span-2',
    className
  ]}
>
  <!-- Image Container -->
  <div class:list={[
    'relative overflow-hidden bg-neutral-200 dark:bg-neutral-800 mb-4',
    featured ? 'aspect-wide' : 'aspect-photo'
  ]}>
    {image ? (
      <img 
        src={image} 
        alt={title}
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
        loading="lazy"
      />
    ) : (
      <div class="w-full h-full bg-gradient-to-br from-neutral-300 to-neutral-400 dark:from-neutral-700 dark:to-neutral-800 group-hover:scale-105 transition-transform duration-700" />
    )}
    
    <!-- Overlay on hover -->
    <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors duration-300" />
    
    <!-- View Project indicator -->
    <div class="absolute bottom-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
      <span class="inline-flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-neutral-900 text-sm font-medium">
        {lang === 'es' ? 'Ver proyecto' : 'View project'}
        <Icon name="arrow-up-right" size="small" />
      </span>
    </div>
  </div>
  
  <!-- Content -->
  <div>
    <Typography as="p" variant="label" color="muted" class="mb-1">
      {categoryLabel} · {year}
    </Typography>
    
    <Typography as="h3" variant="h4" class="group-hover:text-primary transition-colors mb-2">
      {title}
    </Typography>
    
    <Typography as="p" variant="small" color="muted" class="flex items-center gap-1">
      <Icon name="map-pin" size="small" />
      {location}
    </Typography>
    
    {featured && (
      <Typography as="p" variant="body" color="muted" class="mt-3 line-clamp-2">
        {description}
      </Typography>
    )}
  </div>
</a>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

